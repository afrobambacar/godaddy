<!DOCTYPE html>
<html>
<head>
  <title>Math</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <style>
    .result {
      font-size: 200px;
    }
  </style>
</head>
<body>
  <div class="jumbotron">
    <div class="container">
      <h1>로아를 위한 수학 연산</h1>
      <form class="form-inline">
        <h1>
          <span class="x">6</span> x <span class="y">6</span> = <input type="number" class="form-control input-lg answer" pattern="[0-9]">
        </h1>

        <button class="btn btn-primary btn-lg challenge">맞추기</button>
        <button class="btn btn-default btn-lg skip" role="button">어려워요</button>
      </form>
      <ul class="list-unstyled">
        <li>딩동댕: <span class="correct_count"></span></li>
        <li>땡: <span class="incorrect_count"></span></li>
        <li>패스: <span class="skip_count"></span></li>
      </ul>
    </div>
  </div>
  <center>
    <h1 class="result"></h1>
  <center>

  <script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
  <script>
    function Quiz() {
      this._skip = 0;
      this._correct = 0;
      this._incorrect = 0;

      this.initialize();
    }

    $.extend(Quiz.prototype, {
      initialize: function () {
        this.handlers = {
          'form submit': 'doNothing',
          '.challenge click': 'challenge',
          '.skip click': 'skip'
        };

        this.registerHandler();
        this.generateQuiz();
      },
      registerHandler: function () {
        var self = this;
        $.each(this.handlers, function(k, v) {
          var split = k.split(" ");
          var el = split[0];
          var trigger = split[1];

          $(document).delegate(el, trigger, self[v].bind(self));
        });
      },
      generateQuiz: function () {
        this.x = this.getNumber();
        this.y = this.getNumber();
        this.z = this.x * this.y;
        
        this.render();
      },
      render: function () {
        $('.x').text(this.x);
        $('.y').text(this.y);
        $('.correct_count').text(this._correct);
        $('.incorrect_count').text(this._incorrect);
        $('.skip_count').text(this._skip);
        $('.answer').val('');
        $('.answer').focus();
      },
      getNumber: function () {
        return Math.floor(Math.random() * 10);
      },
      challenge: function (e) {
        var answer = $('.answer').val();
        var z = parseInt(answer, 10);

        if (this.z === z) {
          $('.result').text('딩동댕').fadeIn().delay(1000).fadeOut();
          this._correct = this._correct + 1;
          this.generateQuiz();
          return;
        }
        $('.result').text('땡').fadeIn().delay(1000).fadeOut();
        this._incorrect = this._incorrect + 1;
        this.generateQuiz();
        return;
      },
      skip: function (e) {
        e.preventDefault();
        this._skip = this._skip + 1;
        this.generateQuiz();
      },
      doNothing: function (e) {
        e.preventDefault();
      }
    });
    
    var quiz = new Quiz();

  </script>
</body>
</html>